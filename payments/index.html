<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Payment</title>
    <link rel="stylesheet" href="./styles.css">
</head>
<body>

    <h1 id="payment-ammount">Pay 0</h1>

    <button id="succes-button" class="btn-success">
       Success
    </button>

    <button id="failure-button" class="btn-error">
        Failure
     </button>

     <script>

        var sdkParent = null
        var price = 0

        var setPrice = (price) =>{
            price = price;
            document.querySelector("#payment-ammount").innerHTML = `Pay ${price}`
        }

        window.addEventListener("message", (event) => {
            console.log("in payments",event)
            if (event.origin === window.parent.location.origin){
               console.log("in payments",event.origin, window.parent.location.origin )
               sdkParent = window.parent
               setPrice(event.data.options.price)
            }
        }, false);

        document.querySelector("#succes-button").addEventListener("click", ()=>{
            sdkParent.postMessage({ eventName: 'payment_success', data : {id : 'some_id_from_server'} }, '*')
        })

        document.querySelector("#failure-button").addEventListener("click", ()=>{
            sdkParent.postMessage({ eventName: 'payment_failed', error : {message : 'dummy error thrown'} }, '*')
        })

     </script>
</body>
</html>